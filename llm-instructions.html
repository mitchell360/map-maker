<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Historical Map - LLM Instructions</title>
  <style>
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
      line-height: 1.6;
      max-width: 900px;
      margin: 0 auto;
      padding: 20px;
      background: #f5f5f5;
      color: #333;
    }
    h1 {
      color: #0369a1;
      border-bottom: 3px solid #0369a1;
      padding-bottom: 10px;
    }
    h2 {
      color: #0369a1;
      margin-top: 30px;
    }
    h3 {
      color: #6b7280;
      margin-top: 20px;
    }
    code {
      background: #1f2937;
      color: #10b981;
      padding: 2px 6px;
      border-radius: 3px;
      font-size: 0.9em;
    }
    pre {
      background: #1f2937;
      color: #e5e7eb;
      padding: 15px;
      border-radius: 6px;
      overflow-x: auto;
      border-left: 4px solid #0369a1;
    }
    pre code {
      background: transparent;
      color: #e5e7eb;
      padding: 0;
    }
    .parameter {
      background: white;
      padding: 15px;
      margin: 15px 0;
      border-radius: 6px;
      border-left: 4px solid #0369a1;
      box-shadow: 0 1px 3px rgba(0,0,0,0.1);
    }
    .parameter strong {
      color: #0369a1;
    }
    ul {
      background: white;
      padding: 20px 20px 20px 40px;
      border-radius: 6px;
      box-shadow: 0 1px 3px rgba(0,0,0,0.1);
    }
    li {
      margin: 8px 0;
    }
    .example {
      background: #f0f9ff;
      padding: 15px;
      border-radius: 6px;
      margin: 15px 0;
      border-left: 4px solid #0ea5e9;
    }
    .tip {
      background: #fefce8;
      padding: 15px;
      border-radius: 6px;
      margin: 15px 0;
      border-left: 4px solid #eab308;
    }
    .note {
      background: #f0fdf4;
      padding: 15px;
      border-radius: 6px;
      margin: 15px 0;
      border-left: 4px solid #22c55e;
    }
    .critical {
      background: #fef2f2;
      padding: 20px;
      border-radius: 6px;
      margin: 20px 0;
      border-left: 4px solid #dc2626;
      font-weight: 600;
    }
    .error-example {
      background: #fef2f2;
      padding: 15px;
      border-radius: 6px;
      margin: 15px 0;
      border-left: 4px solid #dc2626;
    }
    .correct-example {
      background: #f0fdf4;
      padding: 15px;
      border-radius: 6px;
      margin: 15px 0;
      border-left: 4px solid #22c55e;
    }
    .checklist {
      background: #fefce8;
      padding: 15px;
      border-radius: 6px;
      margin: 15px 0;
      border-left: 4px solid #eab308;
    }
    .checklist li {
      list-style: none;
      margin: 10px 0;
    }
    .checklist li:before {
      content: "‚òê ";
      margin-right: 8px;
      font-size: 1.2em;
    }
  </style>
</head>
<body>
  <h1>Historical Map URL Construction Instructions for LLMs</h1>

  <div class="note">
    <p><strong>üìÑ Structured Data Format Available:</strong> LLMs may optionally access a machine-readable JSON version of these instructions at: <a href="https://mitchell360.com/map-maker/llm-instructions.json" style="color:#0369a1;font-weight:600;">llm-instructions.json</a></p>
  </div>

  <div class="critical">
    <p><strong>üéØ CRITICAL: NEW FOOLPROOF FORMAT (2025-10-28)</strong></p>
    <p>Locations and labels are now <strong>bound together</strong> using the <code>~</code> (tilde) separator within a single parameter. This architecture makes it <strong>impossible to create count mismatch errors</strong>.</p>
    <p><strong>Key Rule:</strong> Every location MUST be paired with its label using <code>~</code> before adding it to the URL.</p>
  </div>

  <h2>Service Overview</h2>
  <p>This is a historical map visualization service that displays locations on ancient and modern maps using Leaflet.js. It supports two types of locations: <strong>chronological</strong> (connected journey points with blue markers) and <strong>reference</strong> (standalone locations with red markers).</p>

  <h2>Base URL Structure</h2>
  <pre><code>https://mitchell360.com/map-maker/?[parameters]</code></pre>

  <h2>URL Parameters</h2>

  <div class="parameter">
    <h3>Chronological Locations (Blue Markers - Connected Journey)</h3>
    <strong>Parameter Name:</strong> <code>chronoLocationsAndLabels</code><br>
    <strong>Structure:</strong> Each location is bound to its label with <code>~</code><br>
    <strong>Format:</strong> <code>Location1~Label1|Location2~Label2|Location3~Label3</code><br>
    <strong>Separators:</strong>
    <ul style="margin-top:10px;">
      <li><code>~</code> (tilde) = Binds location to its label (MANDATORY)</li>
      <li><code>|</code> (pipe) = Separates multiple location-label pairs</li>
      <li><code>%0A</code> = Newline within labels</li>
      <li><code>%0A%0A</code> = Blank line within labels</li>
    </ul>
  </div>

  <div class="parameter">
    <h3>Reference Locations (Red Markers - Standalone)</h3>
    <strong>Parameter Name:</strong> <code>referenceLocationsAndLabels</code><br>
    <strong>Structure:</strong> Each location is bound to its label with <code>~</code><br>
    <strong>Format:</strong> <code>Location1~Label1|Location2~Label2</code><br>
    <strong>Separators:</strong> Same as chronological locations
  </div>

  <div class="parameter">
    <h3>Map Title (Optional)</h3>
    <strong>Parameter Name:</strong> <code>title</code><br>
    <strong>Purpose:</strong> Displays a centered title at the top of the map (visible during loading and after map loads)<br>
    <strong>Format:</strong> <code>URL-encoded text string</code><br>
    <strong>Default:</strong> If no title parameter is provided, displays <code>"Paul's Missionary Journeys"</code><br>
    <strong>Example:</strong> <code>title=Paul's%20Second%20Missionary%20Journey</code><br>
    <strong>Note:</strong> Spaces become <code>%20</code>, special characters should be URL-encoded. The title appears above the loading overlay and remains visible throughout.
  </div>

  <h2>Label Format: 5-Line Structure (Highly Recommended)</h2>
  <p>For rich, professional popups, structure each label with 5 lines:</p>
  <ol>
    <li><strong>Line 1:</strong> Location name only (becomes marker label and popup title)</li>
    <li><strong>Line 2:</strong> Historical context ‚Üí Format: <code>YEAR AD: AncientName, AncientRegion</code></li>
    <li><strong>Line 3:</strong> Modern context ‚Üí Format: <code>YEAR AD: ModernName, ModernCountry</code></li>
    <li><strong>Line 4:</strong> Blank line ‚Üí Use <code>%0A%0A</code> (two newlines)</li>
    <li><strong>Line 5+:</strong> Detailed description (can be multiple lines)</li>
  </ol>

  <div class="example">
    <h4>Complete Label Example:</h4>
    <pre><code>Philippi~Philippi%0A49-50 AD: Philippi, Macedonia%0A2025 AD: Filippoi, Greece%0A%0APhilippi was the first European city where Paul established a Christian congregation during his second missionary journey.</code></pre>
    <p><strong>Breakdown:</strong></p>
    <ul>
      <li>Location: <code>Philippi</code></li>
      <li>Line 1: <code>Philippi</code></li>
      <li>Line 2: <code>49-50 AD: Philippi, Macedonia</code></li>
      <li>Line 3: <code>2025 AD: Filippoi, Greece</code></li>
      <li>Line 4: <code>(blank line)</code></li>
      <li>Line 5: <code>Philippi was the first European city...</code></li>
    </ul>
  </div>

  <h2>Step-by-Step Construction Process</h2>

  <h3>Step 1: List Your Locations</h3>
  <p>Write out each location you want to show. Use <code>City, Country</code> format for accurate geocoding.</p>
  <div class="example">
    <strong>Example List:</strong>
    <ul>
      <li>Damascus, Syria</li>
      <li>Antioch, Turkey</li>
      <li>Philippi, Greece</li>
      <li>Rome, Italy</li>
    </ul>
  </div>

  <h3>Step 2: Create Label for EACH Location</h3>
  <p><strong>CRITICAL:</strong> You must create a label for every single location. Use the 5-line format.</p>
  <div class="example">
    <strong>Example Labels:</strong>
    <pre><code>Damascus%0A32 AD: Damascus, Syria%0A2025 AD: Damascus, Syria%0A%0AConversion of Saul

Antioch%0A47 AD: Antioch, Syria%0A2025 AD: Antakya, Turkey%0A%0AMission base

Philippi%0A50 AD: Philippi, Macedonia%0A2025 AD: Filippoi, Greece%0A%0AFirst European church

Rome%0A62 AD: Rome, Roman Empire%0A2025 AD: Rome, Italy%0A%0AHouse arrest ministry</code></pre>
  </div>

  <h3>Step 3: Bind Each Location to Its Label with ~</h3>
  <p><strong>MANDATORY STEP:</strong> Connect each location to its label using the tilde separator.</p>
  <div class="example">
    <strong>Binding Format:</strong>
    <pre><code>Damascus,Syria~Damascus%0A32 AD: Damascus, Syria%0A2025 AD: Damascus, Syria%0A%0AConversion of Saul

Antioch,Turkey~Antioch%0A47 AD: Antioch, Syria%0A2025 AD: Antakya, Turkey%0A%0AMission base

Philippi,Greece~Philippi%0A50 AD: Philippi, Macedonia%0A2025 AD: Filippoi, Greece%0A%0AFirst European church

Rome,Italy~Rome%0A62 AD: Rome, Roman Empire%0A2025 AD: Rome, Italy%0A%0AHouse arrest ministry</code></pre>
  </div>

  <h3>Step 4: Join Pairs with | (Pipe)</h3>
  <p>Connect all location~label pairs using the pipe character.</p>
  <div class="correct-example">
    <strong>‚úÖ CORRECT:</strong>
    <pre><code>Damascus,Syria~Damascus%0A32 AD|Antioch,Turkey~Antioch%0A47 AD|Philippi,Greece~Philippi%0A50 AD|Rome,Italy~Rome%0A62 AD</code></pre>
  </div>

  <h3>Step 5: Add Parameter Name and Build Final URL</h3>
  <div class="correct-example">
    <strong>‚úÖ COMPLETE URL:</strong>
    <pre><code>https://mitchell360.com/map-maker/?chronoLocationsAndLabels=Damascus,Syria~Damascus%0A32 AD|Antioch,Turkey~Antioch%0A47 AD|Philippi,Greece~Philippi%0A50 AD|Rome,Italy~Rome%0A62 AD</code></pre>
  </div>

  <h2>‚ö†Ô∏è Common Mistakes to AVOID</h2>

  <div class="error-example">
    <h4>‚ùå ERROR: Separate Arrays (Old Deprecated Format)</h4>
    <p><strong>Problem:</strong> Using separate parameters causes count mismatches</p>
    <pre><code>?chrono=Damascus,Syria|Antioch,Turkey|Philippi,Greece|Rome,Italy
&chronoLabels=Damascus|Antioch|Philippi</code></pre>
    <p><strong>Why This Fails:</strong> 4 locations but only 3 labels ‚Üí mismatch error</p>
  </div>

  <div class="error-example">
    <h4>‚ùå ERROR: Missing ~ Separator</h4>
    <pre><code>?chronoLocationsAndLabels=Damascus,Syria|Antioch,Turkey|Rome,Italy</code></pre>
    <p><strong>Problem:</strong> No labels provided, just locations</p>
  </div>

  <div class="error-example">
    <h4>‚ùå ERROR: Wrong Separator</h4>
    <pre><code>?chronoLocationsAndLabels=Damascus,Syria:Damascus|Antioch,Turkey:Antioch</code></pre>
    <p><strong>Problem:</strong> Using <code>:</code> instead of <code>~</code></p>
  </div>

  <div class="correct-example">
    <h4>‚úÖ CORRECT: Bound Pairs with ~</h4>
    <pre><code>?chronoLocationsAndLabels=Damascus,Syria~Damascus|Antioch,Turkey~Antioch|Rome,Italy~Rome</code></pre>
    <p><strong>Why This Works:</strong> Each location is permanently bound to its label</p>
  </div>

  <h2>Pre-Construction Validation Checklist</h2>
  <div class="checklist">
    <strong>Before generating the URL, verify:</strong>
    <ul>
      <li>Every location is in <code>City, Country</code> format</li>
      <li>Every location has a corresponding label created</li>
      <li>Each location~label pair uses <code>~</code> (tilde) to bind them</li>
      <li>Multiple pairs are separated by <code>|</code> (pipe)</li>
      <li>Labels use <code>%0A</code> for newlines, not actual line breaks</li>
      <li>Spaces in text use <code>%20</code> (automatic in most systems)</li>
      <li>The parameter name is <code>chronoLocationsAndLabels</code> (not chrono)</li>
      <li>URL starts with <code>https://mitchell360.com/map-maker/?</code></li>
    </ul>
  </div>

  <h2>Complete Working Examples</h2>

  <div class="example">
    <h3>Example 1: Simple 2-Location Journey</h3>
    <pre><code>https://mitchell360.com/map-maker/?chronoLocationsAndLabels=Damascus,Syria~Damascus%0A32 AD|Antioch,Turkey~Antioch%0A47 AD</code></pre>
    <p><strong>Displays:</strong> Two blue markers connected by a walking path</p>
  </div>

  <div class="example">
    <h3>Example 2: Rich 3-Location Journey with Full Labels</h3>
    <pre><code>https://mitchell360.com/map-maker/?chronoLocationsAndLabels=Antioch,Turkey~Antioch%0A47-48 AD: Antioch, Syria%0A2025 AD: Antakya, Turkey%0A%0AAntioch served as Paul's primary mission base for ministry to the Gentiles and was where believers were first called Christians.|Philippi,Greece~Philippi%0A49-50 AD: Philippi, Macedonia%0A2025 AD: Filippoi, Greece%0A%0APhilippi was the first European city where Paul established a Christian congregation during his second missionary journey.|Rome,Italy~Rome%0A60-62 AD: Rome, Roman Empire%0A2025 AD: Rome, Italy%0A%0APaul was held under house arrest in Rome from approximately AD 60 to 62.</code></pre>
    <p><strong>Displays:</strong> Three locations with rich historical context popups</p>
  </div>

  <div class="example">
    <h3>Example 3: Journey + Reference Location</h3>
    <pre><code>https://mitchell360.com/map-maker/?chronoLocationsAndLabels=Antioch,Turkey~Antioch%0A47 AD|Rome,Italy~Rome%0A62 AD&referenceLocationsAndLabels=Jerusalem,Israel~Jerusalem%0A33 AD: Jerusalem, Judea%0A2025 AD: Jerusalem, Israel%0A%0AThe Church's birthplace and site of Pentecost</code></pre>
    <p><strong>Displays:</strong> Two blue markers (connected) + one red marker (standalone reference)</p>
  </div>

  <div class="example">
    <h3>Example 4: Paul's Full Second Missionary Journey</h3>
    <pre><code>https://mitchell360.com/map-maker/?chronoLocationsAndLabels=Antioch,Turkey~Antioch%0A49 AD|Derbe,Turkey~Derbe%0A49 AD|Lystra,Turkey~Lystra%0A49 AD|Iconium,Turkey~Iconium%0A49 AD|Philippi,Greece~Philippi%0A50 AD|Thessalonica,Greece~Thessalonica%0A50 AD|Berea,Greece~Berea%0A50 AD|Athens,Greece~Athens%0A51 AD|Corinth,Greece~Corinth%0A51-52 AD</code></pre>
    <p><strong>Displays:</strong> Complete journey with 9 connected locations</p>
  </div>

  <h2>Encoding Reference</h2>
  <div class="parameter">
    <strong>Character Encoding for URLs:</strong>
    <ul style="margin-top:10px;">
      <li><code>~</code> (tilde) ‚Üí Use as-is (location~label separator)</li>
      <li><code>|</code> (pipe) ‚Üí Use as-is (pair separator)</li>
      <li><code>%0A</code> ‚Üí Newline character</li>
      <li><code>%0A%0A</code> ‚Üí Blank line (double newline)</li>
      <li><code>%20</code> ‚Üí Space (usually automatic)</li>
      <li><code>&</code> ‚Üí Parameter separator</li>
    </ul>
  </div>

  <h2>Placeholder Handling</h2>
  <div class="note">
    <strong>If you don't have complete information:</strong>
    <ul>
      <li>Use <code>Location~TBD</code> to explicitly mark incomplete data</li>
      <li>The map will display a prominent "TBD" warning in the popup</li>
      <li>Example: <code>Damascus,Syria~TBD</code> shows placeholder message</li>
    </ul>
  </div>

  <h2>Map Features</h2>
  <div class="note">
    <ul>
      <li><strong>Base Maps:</strong> Ancient World (DARE - default), Modern Clean, Modern Detailed</li>
      <li><strong>Overlays:</strong> Country Borders, Walking Paths, Travel Time estimates (toggle in layer control)</li>
      <li><strong>Mobile Friendly:</strong> Bottom drawer interface on phones (‚â§768px), traditional popups on desktop</li>
      <li><strong>Interactions:</strong> Click/tap markers for detailed information</li>
      <li><strong>Instructions:</strong> Top-right link on desktop, bottom-right "?" icon on mobile</li>
    </ul>
  </div>

  <h2>Final Validation Steps</h2>
  <div class="checklist">
    <strong>Before providing URL to user:</strong>
    <ul>
      <li>URL starts with <code>https://mitchell360.com/map-maker/?</code></li>
      <li>Every <code>~</code> has a location on left and label on right</li>
      <li>All pairs are separated by <code>|</code></li>
      <li>No spaces in URL except encoded as <code>%20</code></li>
      <li>Labels use <code>%0A</code> for line breaks</li>
      <li>URL is under 8000 characters</li>
    </ul>
  </div>

  <h2>Response Format to Users</h2>
  <p>When providing URLs, include:</p>
  <ul>
    <li>The complete working URL</li>
    <li>Brief description (e.g., "This map shows Paul's second missionary journey with 6 locations")</li>
    <li>Note about optional features (e.g., "Toggle 'Walking Paths' overlay to see routes")</li>
  </ul>

</body>
</html>
